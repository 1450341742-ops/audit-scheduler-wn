{% extends "base.html" %}
{% block content %}
<h4 class="mb-3">城市距离表（用于就近/成本计算）</h4>
<div class="alert alert-info">
  <b>注意排班：</b>建议优先维护你们常见城市对（如北京/上海/广州/苏州/天津/沈阳等），否则系统会使用默认距离，影响“就近”准确性。
</div>
<div class="card mb-4">
  <div class="card-body">
    <form class="row g-2" method="post" action="/distances/upsert">
      <div class="col-md-3"><input class="form-control" name="from_city" placeholder="出发城市" required>
        <div class="form-text">出发城市（可为BASE或last_city）。</div></div>
      <div class="col-md-3"><input class="form-control" name="to_city" placeholder="到达城市" required>
        <div class="form-text">到达城市（通常为中心地点）。</div></div>
      <div class="col-md-2"><input class="form-control" name="km" type="number" step="0.1" min="0" placeholder="公里数" required>
        <div class="form-text">两城市间距离（公里）。用于就近/成本/链式判定。</div></div>
      <div class="col-md-2"><button class="btn btn-primary w-100">新增/更新</button></div>
    </form>
    <div class="form-text mt-2">说明：系统已内置【全国主要省会/直辖市(含港澳)】城市对直线距离（首次启动会自动写入距离表）。你无需录入全国距离；仅当出现非省会城市时，可在此页补充少量城市对。</div>
  </div>
</div>

<div class="table-responsive"><table class="table table-sm table-striped bg-white">
  <thead><tr><th>ID</th><th>from</th><th>to</th><th>km</th><th></th></tr></thead>
  <tbody>
  {% for d in dists %}
    <tr>
      <td>{{d.id}}</td><td>{{d.from_city}}</td><td>{{d.to_city}}</td><td>{{d.km}}</td>
      <td><form method="post" action="/distances/delete/{{d.id}}"><button class="btn btn-outline-danger btn-sm">删除</button></form></td>
    </tr>
  {% endfor %}
  </tbody>
</table></div>
{% endblock %}
