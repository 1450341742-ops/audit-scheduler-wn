# 内置城市直线距离（km）：覆盖常用城市列表（含北京/上海/广州/天津/沈阳等）

# 城市坐标（纬度, 经度），用于自动计算直线距离
CITY_COORDS = {
    "北京": (39.9042, 116.4074),
    "上海": (31.2304, 121.4737),
    "广州": (23.1291, 113.2644),
    "天津": (39.3434, 117.3616),
    "沈阳": (41.8057, 123.4315),
    "石家庄": (38.0428, 114.5149),
    "太原": (37.8706, 112.5489),
    "呼和浩特": (40.8426, 111.749),
    "大连": (38.914, 121.6147),
    "长春": (43.8171, 125.3235),
    "哈尔滨": (45.8038, 126.5349),
    "济南": (36.6512, 117.1201),
    "青岛": (36.0671, 120.3826),
    "南京": (32.0603, 118.7969),
    "苏州": (31.2989, 120.5853),
    "无锡": (31.4912, 120.3119),
    "杭州": (30.2741, 120.1551),
    "宁波": (29.8683, 121.544),
    "合肥": (31.8206, 117.2272),
    "福州": (26.0745, 119.2965),
    "厦门": (24.4798, 118.0894),
    "武汉": (30.5928, 114.3055),
    "郑州": (34.7466, 113.6254),
    "长沙": (28.2282, 112.9388),
    "南昌": (28.682, 115.8582),
    "深圳": (22.5431, 114.0579),
    "珠海": (22.2707, 113.5767),
    "佛山": (23.0215, 113.1214),
    "东莞": (23.0207, 113.7518),
    "南宁": (22.817, 108.3669),
    "海口": (20.044, 110.1983),
    "成都": (30.5728, 104.0668),
    "重庆": (29.563, 106.5516),
    "昆明": (25.0389, 102.7183),
    "贵阳": (26.647, 106.6302),
    "西安": (34.3416, 108.9398),
    "兰州": (36.0611, 103.8343),
    "西宁": (36.6171, 101.7782),
    "银川": (38.4872, 106.2309),
    "乌鲁木齐": (43.8256, 87.6168),
}

CITY_LIST = [
    "北京",
    "上海",
    "广州",
    "天津",
    "沈阳",
    "石家庄",
    "太原",
    "呼和浩特",
    "大连",
    "长春",
    "哈尔滨",
    "济南",
    "青岛",
    "南京",
    "苏州",
    "无锡",
    "杭州",
    "宁波",
    "合肥",
    "福州",
    "厦门",
    "武汉",
    "郑州",
    "长沙",
    "南昌",
    "深圳",
    "珠海",
    "佛山",
    "东莞",
    "南宁",
    "海口",
    "成都",
    "重庆",
    "昆明",
    "贵阳",
    "西安",
    "兰州",
    "西宁",
    "银川",
    "乌鲁木齐",
]

def _haversine_km(lat1, lon1, lat2, lon2):
    from math import radians, sin, cos, sqrt, atan2
    R = 6371.0
    dlat = radians(lat2 - lat1)
    dlon = radians(lon2 - lon1)
    a = sin(dlat/2)**2 + cos(radians(lat1)) * cos(radians(lat2)) * sin(dlon/2)**2
    c = 2 * atan2(sqrt(a), sqrt(1 - a))
    return R * c

def build_seed_distances():
    """生成内置距离（包含双向）。"""
    out = []
    for i, a in enumerate(CITY_LIST):
        for b in CITY_LIST[i+1:]:
            lat1, lon1 = CITY_COORDS[a]
            lat2, lon2 = CITY_COORDS[b]
            km = round(_haversine_km(lat1, lon1, lat2, lon2), 1)
            out.append((a, b, km))
            out.append((b, a, km))
    return out

# 用于系统初始化写入数据库
SEED_CITY_DISTANCES = build_seed_distances()
